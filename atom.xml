<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://linjiang.tech/tips/atom.xml</id>
    <title>linjiang&apos;s tips</title>
    <updated>2023-01-13T08:48:04Z</updated>
    <author>
        <name>linjiang</name>
        <email>linjiang.me@gmail.com</email>
        <uri>linjiang</uri>
    </author>
    <link rel="alternate" href="https://linjiang.tech/tips/"/>
    <generator>Feed for Node.js</generator>
    <entry>
        <title type="html"><![CDATA[facebook hermes ç¼–è¯‘]]></title>
        <id>https://linjiang.tech/tips/index.html</id>
        <link href="https://linjiang.tech/tips/index.html">
        </link>
        <updated>2023-01-13T08:48:02Z</updated>
        <content type="html"><![CDATA[<h3>åŸºæœ¬ç¯å¢ƒ</h3>
<pre><code class="lang-shell"># æŒ‰éœ€å®‰è£…
brew install cmake git ninja
# å‡†å¤‡workspace
mkdir github_hermes_workspace
cd github_hermes_workspace/
# ç¯å¢ƒå˜é‡ï¼Œå¾ˆé‡è¦ï¼Œç¼–è¯‘hermes.soæ—¶ï¼Œhermes/android/build.gradleå·¥ç¨‹ä¼šè¯»å–ä½¿ç”¨
export HERMES_WS_DIR=&quot;$(pwd)&quot;
# cloneï¼Œä½œä¸ºworkspaceå­ç›®å½•
git clone https://github.com/facebook/hermes.git github_hermes
</code></pre>
<h3>ç¼–è¯‘hermesc</h3>
<pre><code class="lang-shell"># æ„å»ºbuildç›®å½•
## ç”±äº hermes/android/build.gradle é‡Œå†™æ­»äº†è·¯å¾„ï¼ˆbuild|build_releaseï¼‰ï¼Œä¸æ”¹æºç çš„å‰æä¸‹å°±ç”¨å‰è¿°ä¸¤ä¸ªï¼š
## RELEASE: cmake -S github_hermes -B build_release -G Ninja -DCMAKE_BUILD_TYPE=Release
cmake -S github_hermes -B build -G Ninja
# build hermesc
## --build æŒ‡å®šçš„æ˜¯ä¸Šè¿°å‘½ä»¤çš„è¾“å‡ºè·¯å¾„
cmake --build ./build --target hermesc
# hermescä½ç½®ï¼šä½äº --build æŒ‡å®šçš„ç›®å½•ä¸‹
find . | grep -E &quot;hermesc$&quot;
</code></pre>
<h3>ç¼–è¯‘hermes.so</h3>
<p>æŒ‡å®šNDKç‰ˆæœ¬ï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œä¿è¯å’Œè¦ä½¿ç”¨hermesçš„å·¥ç¨‹çš„ç‰ˆæœ¬ä¸€è‡´ï¼ˆç›®å‰å·²å‘ç°çš„é—®é¢˜æ˜¯try-catchå¤±æ•ˆï¼‰ï¼Œæ–¹å¼ï¼š</p>
<ul>
<li>android.ndkVersion ï¼ˆéœ€è¦æ›´æ”¹hermes/android/hermes/build.gradleï¼‰</li>
<li>android.ndkPath ï¼ˆéœ€è¦æ›´æ”¹hermes/android/hermes/build.gradleï¼‰</li>
<li>ndk.dir @ local.properties</li>
</ul>
<p>ä¸€äº›è¯´æ˜ï¼š</p>
<ul>
<li>Intl è¡¨ç¤ºå›½é™…åŒ–ç‰ˆæœ¬</li>
<li>ä¸ç®¡æ˜¯debugè¿˜æ˜¯releaseçš„libhermes.soï¼ŒCMAKE_BUILD_TYPEéƒ½æ˜¯ä¸ºRelease<ul>
<li>JS developers aren&#39;t VM developers. Give them a faster build.</li>
</ul>
</li>
<li>releaseçš„å‚æ•°ï¼š<ul>
<li>HERMES_ENABLE_DEBUGGER=false // å³debugçš„soå¸¦inspector</li>
<li>CMAKE_BUILD_TYPE=MinSizeRel</li>
</ul>
</li>
<li>æ··æ·†è§„åˆ™ï¼š<pre><code>  -keep class com.facebook.hermes.unicode.** { *; }
  -keep class com.facebook.jni.** { *; }
</code></pre><pre><code class="lang-shell">cd hermes/android/
chmod +x gradlew
# buildç›®å½•åœ¨ ${HERMES_WS_DIR}/build_android/
./gradlew build
# soä½ç½®ï¼š
cd $HERMES_WS_DIR
find . | grep -E &quot;libhermes\.so$&quot;
</code></pre>
</li>
</ul>
<h3>jsè½¬hbc</h3>
<pre><code class="lang-shell">hermes -emit-binary -out test.hbc test.js
</code></pre>
<h3>è¿è¡ŒRN demo</h3>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://reactnative.dev/docs/environment-setup">https://reactnative.dev/docs/environment-setup</a></p>
<pre><code>npx react-native init AwesomeProject
npx react-native run-android
</code></pre></blockquote>
<h3>æ›´å¤š</h3>
<ul>
<li><a href="https://hermesengine.dev/docs/cross-compilation">https://hermesengine.dev/docs/cross-compilation</a></li>
<li><a href="https://reactnative.dev/docs/hermes#debugging-js-on-hermes-using-google-chromes-devtools">ä½¿ç”¨Chromeè°ƒè¯•è¿è¡Œåœ¨hermesçš„JSä»£ç </a></li>
</ul>
]]></content>
        <published>2023-01-11T10:00:00Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[åˆ›åˆŠ Â· å·é¦–è¯­]]></title>
        <id>https://linjiang.tech/tips/src/tips.html</id>
        <link href="https://linjiang.tech/tips/src/tips.html">
        </link>
        <updated>2023-01-13T08:47:26Z</updated>
        <content type="html"><![CDATA[<center>åŸºäº Gitbook 3.2.3 ä½†è°ˆä¸ä¸Šæ„Ÿè°¢ï¼Œæ¯«æ— æ–‡æ¡£å¯è¨€ğŸ™‚</center>

<p><br></p>
<h3>è¨€å½’æ­£ä¼ </h3>
<p>å½“å‰ book ä½œä¸º <a href="https://linjiang.tech">linjiang.tech</a> åšå®¢çš„è¡¥å……ï¼Œå……å½“ä¸€ä¸ªçŸ¥è¯†å°é›†é”¦çš„ä½œç”¨ã€‚</p>
]]></content>
        <published>2020-05-12T10:00:00Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[raw size å’Œ download size çš„åŒºåˆ«]]></title>
        <id>https://linjiang.tech/tips/src/apk-size-diff.html</id>
        <link href="https://linjiang.tech/tips/src/apk-size-diff.html">
        </link>
        <updated>2023-01-13T08:47:26Z</updated>
        <content type="html"><![CDATA[<p>å‚ç…§<a href="https://developer.android.com/studio/build/apk-analyzer#view_file_and_size_information">å®˜æ–¹æ–‡æ¡£</a> çš„è§£é‡Šï¼š</p>
<ul>
<li>Raw File Size è¡¨ç¤ºå®ä½“åœ¨ç£ç›˜ä¸Šæœªç»å‹ç¼©æ—¶çš„å¤§å°ï¼›</li>
<li>Download Size åˆ™è¡¨ç¤ºå®ä½“ç”± Google Play æä¾›æ—¶ä¼°è®¡å‹ç¼©åçš„å¤§å°ï¼›</li>
</ul>
<p>è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ apk ä¸Šä¼ è‡³ google play åä¼šè¢«å†æ¬¡å¤„ç†ï¼ˆå‹ç¼©ï¼‰ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æ•°æ®é‡ï¼Œå¾…æ‰‹æœºç«¯ä¸‹è½½å®Œæˆåè¢«è¿˜åŸä¸ºåŸå§‹æ–‡ä»¶ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ <code>raw size</code> å°±æ˜¯apkçš„æœ¬èº«å¤§å°ï¼ˆå½“ç„¶ä¹Ÿå¹¶éè§£å‹åçš„ç›®å½•å¤§å°ï¼‰ï¼›
<code>download size</code> å°±æ˜¯å®é™…ä¸‹è½½æ—¶æ¶ˆè€—çš„æµé‡å¤§å°ã€‚</p>
]]></content>
        <published>2020-04-25T10:00:00Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[.ap_ æ–‡ä»¶çš„ä½œç”¨]]></title>
        <id>https://linjiang.tech/tips/src/ap.html</id>
        <link href="https://linjiang.tech/tips/src/ap.html">
        </link>
        <updated>2023-01-13T08:47:26Z</updated>
        <content type="html"><![CDATA[<ul>
<li><p>AAPT2 å°†AAPT å¯¹èµ„æºçš„ç¼–è¯‘æ‹†åˆ†ç»†åŒ–ä¸ºäº† <code>compile</code> å’Œ <code>link</code> ä¸¤ä¸ªæ­¥éª¤ï¼Œä»¥æ›´å¥½åœ°æå‡ç¼–è¯‘é€Ÿåº¦ï¼ˆå¢é‡ç¼–è¯‘ï¼‰ã€‚</p>
</li>
<li><p>å…¶ä¸­ link çš„ç»“æœé™¤äº†ç”Ÿæˆ <code>R.java</code> å¤–ï¼Œè¿˜ç”Ÿæˆäº† <code>.ap_</code> äº§ç‰©ï¼ˆæœ¬è´¨ä¸Šæ˜¯zipï¼‰ï¼ŒåŒ…å« <code>manifest</code> æ¸…å•ã€æ‰€æœ‰èµ„æºæ–‡ä»¶ä»¥åŠèµ„æºç´¢å¼•è¡¨<code>arsc</code>ã€‚</p>
</li>
<li><p>å½“æ‰§è¡Œ package-task ç”Ÿæˆ .apk æ—¶å¹¶ä¸æ˜¯è§£å‹.ap<em>æ–‡ä»¶å¾—åˆ°ç›¸å…³èµ„æºå†ä¸dexé‡æ–°å‹ç¼©ï¼Œè€Œæ˜¯ä»¥ <strong>copy zip entry</strong> çš„å½¢å¼ç›´æ¥æ‹·è´åˆ°æœ€ç»ˆçš„apkæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ.ap</em> æ–‡ä»¶ä¸­å„ä¸ªentryçš„å‹ç¼©æ•ˆæœä¸apkä¸­ä¸€è‡´ã€‚</p>
</li>
</ul>
]]></content>
        <published>2020-04-20T10:00:00Z</published>
    </entry>
</feed>